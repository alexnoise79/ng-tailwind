<div class="flex flex-nowrap w-full">
  <div class="relative flex-shrink-0 w-[80px] overflow-hidden rounded-l-md border border-r-0 border-gray-300 dark:border-gray-600 [&:has(select:disabled)]:border-gray-300 [&:has(select:disabled)]:dark:border-gray-600">
    @if (model && model.country) {
      <div class="absolute inset-[1px] flex items-center gap-1 px-2.5 pointer-events-none bg-white dark:bg-gray-800 text-gray-900 dark:text-white border-0 leading-none">
        @if (model.country.code && ((model.country.code.length > 2 ? (model.country.code | slice: 3 : 5) : model.country.code) | lowercase); as code) {
          <i class="flag flag-{{ code | lowercase }}"></i>
        }
        <div class="flex flex-col max-w-[70px]">
          <div class="text-xs truncate max-w-[50px]">{{ model.country.code || '' }}</div>
          <div class="text-[10px]">(+{{ model.country.dialCode }})</div>
        </div>
      </div>
      <select
        [(ngModel)]="model.country"
        [disabled]="isDisabled"
        (ngModelChange)="update(model)"
        class="w-full h-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border-0 rounded-l-md rounded-r-none focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:opacity-50 disabled:cursor-not-allowed shadow-none [&:disabled]:invisible"
        aria-label="prefix"
        id="mobile-prefix"
      >
        @for (c of values(); track c) {
          <option [ngValue]="c">{{ c.name }} ({{ c.dialCode }})</option>
        }
      </select>
    }
  </div>

  @if (model) {
    <div class="flex flex-1">
      <input
        [(ngModel)]="model.phone"
        [readonly]="readonly()"
        [disabled]="isDisabled"
        [placeholder]="placeholder()"
        (input)="onInput($event)"
        (blur)="onBlurEvent($event)"
        (ngModelChange)="update({ phone: $event, country: model.country })"
        class="w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-r-md rounded-l-none focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:opacity-50 disabled:cursor-not-allowed [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none [appearance:textfield]"
        id="mobile-phone"
        type="number"
      />
    </div>
  }
</div>
